YUI.add("photo-selector-photolist-view",(function(e){e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{initializer:function(i){return i.photolistViewClasses&&(i.additionalViewClasses=i.photolistViewClasses),i.photoListConfig=e.merge(i.primaryPhotoListConfig),i.publicOnlyPhotos=i.publicOnlyPhotos,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},subviewConfig:{"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},buildContainer:function(){return this.setContainerWithTemplate("photo-selector-photolist-subview"),this}})}),"@VERSION@",{requires:["flickr-view","photo-list-view","hermes-template-photo-selector-photolist-subview"]});YUI.add("hermes-template-search-photos-single-row",(function(l,n){var e=l.Template.Handlebars.revive({1:function(l,n,e,t,a){var o,r,s,i=null!=n?n:l.nullContext||{},u=l.hooks.helperMissing,c="function",p=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]},h='\t<h5 class="search-results-header">\n\t\t'+(null!=(o=p(e,"unless").call(i,null!=n?p(n,"loading"):n,{name:"unless",hash:{},fn:l.program(2,a,0),inverse:l.noop,data:a,loc:{start:{line:3,column:2},end:{line:7,column:24}}}))?o:"")+"\n\t\t"+l.escapeExpression(typeof(r=null!=(r=p(e,"title")||(null!=n?p(n,"title"):n))?r:u)===c?r.call(i,{name:"title",hash:{},data:a,loc:{start:{line:8,column:2},end:{line:8,column:11}}}):r)+"\n";return r=null!=(r=p(e,"showBetaLabel")||(null!=n?p(n,"showBetaLabel"):n))?r:u,s={name:"showBetaLabel",hash:{},fn:l.program(6,a,0),inverse:l.noop,data:a,loc:{start:{line:9,column:2},end:{line:11,column:20}}},o=typeof r===c?r.call(i,s):r,p(e,"showBetaLabel")||(o=l.hooks.blockHelperMissing.call(n,o,s)),null!=o&&(h+=o),h+(null!=(o=p(e,"if").call(i,null!=n?p(n,"loading"):n,{name:"if",hash:{},fn:l.program(8,a,0),inverse:l.noop,data:a,loc:{start:{line:12,column:2},end:{line:14,column:9}}}))?o:"")+"\t</h5>\n"+(null!=(o=p(e,"if").call(i,null!=n?p(n,"loading"):n,{name:"if",hash:{},fn:l.program(10,a,0),inverse:l.program(12,a,0),data:a,loc:{start:{line:16,column:1},end:{line:20,column:8}}}))?o:"")},2:function(l,n,e,t,a){var o,r=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return null!=(o=r(e,"unless").call(null!=n?n:l.nullContext||{},null!=n?r(n,"singleResult"):n,{name:"unless",hash:{},fn:l.program(3,a,0),inverse:l.noop,data:a,loc:{start:{line:3,column:21},end:{line:7,column:13}}}))?o:""},3:function(l,n,e,t,a){var o,r,s=null!=n?n:l.nullContext||{},i=l.hooks.helperMissing,u=l.escapeExpression,c=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'\n\t\t\t<a href="'+u("function"==typeof(r=null!=(r=c(e,"viewAll")||(null!=n?c(n,"viewAll"):n))?r:i)?r.call(s,{name:"viewAll",hash:{},data:a,loc:{start:{line:4,column:12},end:{line:4,column:23}}}):r)+'" class="view-more-link"'+(null!=(o=c(e,"if").call(s,null!=n?c(n,"viewAllDataTrack"):n,{name:"if",hash:{},fn:l.program(4,a,0),inverse:l.noop,data:a,loc:{start:{line:4,column:47},end:{line:4,column:112}}}))?o:"")+">\n\t\t\t\t"+u((c(e,"intlHTMLMessage")||n&&c(n,"intlHTMLMessage")||i).call(s,{name:"intlHTMLMessage",hash:{count:null!=n?c(n,"total"):n,intlName:"search.VIEW_ALL_COUNT"},data:a,loc:{start:{line:5,column:4},end:{line:5,column:68}}}))+"\n\t\t\t</a>\n\t\t"},4:function(l,n,e,t,a){var o,r=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return' data-track="'+l.escapeExpression("function"==typeof(o=null!=(o=r(e,"viewAllDataTrack")||(null!=n?r(n,"viewAllDataTrack"):n))?o:l.hooks.helperMissing)?o.call(null!=n?n:l.nullContext||{},{name:"viewAllDataTrack",hash:{},data:a,loc:{start:{line:4,column:84},end:{line:4,column:104}}}):o)+'"'},6:function(l,n,e,t,a){var o=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'\t\t\t<span class="label-beta">'+l.escapeExpression((o(e,"intlMessage")||n&&o(n,"intlMessage")||l.hooks.helperMissing).call(null!=n?n:l.nullContext||{},{name:"intlMessage",hash:{intlName:"common.BETA"},data:a,loc:{start:{line:10,column:28},end:{line:10,column:67}}}))+"</span>\n"},8:function(l,n,e,t,a){return'\t\t\t<div class="flickr-dots inline"></div>\n'},10:function(l,n,e,t,a){var o,r=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return'\t\t<div style="height: '+l.escapeExpression("function"==typeof(o=null!=(o=r(e,"placeholderHeight")||(null!=n?r(n,"placeholderHeight"):n))?o:l.hooks.helperMissing)?o.call(null!=n?n:l.nullContext||{},{name:"placeholderHeight",hash:{},data:a,loc:{start:{line:17,column:22},end:{line:17,column:43}}}):o)+'px;"></div>\n'},12:function(l,n,e,t,a){var o=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return"\t\t"+l.escapeExpression((o(e,"outlet")||n&&o(n,"outlet")||l.hooks.helperMissing).call(null!=n?n:l.nullContext||{},null!=n?o(n,"photo-list-view"):n,{name:"outlet",hash:{},data:a,loc:{start:{line:19,column:2},end:{line:19,column:28}}}))+"\n"},compiler:[8,">= 4.3.0"],main:function(l,n,e,t,a){var o,r=l.lookupProperty||function(l,n){if(Object.prototype.hasOwnProperty.call(l,n))return l[n]};return null!=(o=r(e,"unless").call(null!=n?n:l.nullContext||{},null!=n?r(n,"emptySearch"):n,{name:"unless",hash:{},fn:l.program(1,a,0),inverse:l.noop,data:a,loc:{start:{line:1,column:0},end:{line:21,column:11}}}))?o:""},useData:!0}),t={};l.Array.each([],(function(n){var e=l.Template.get("hermes/"+n);e&&(t[n]=e)})),l.Template.register("hermes/search-photos-single-row",(function(n,a){return(a=a||{}).partials=a.partials?l.merge(t,a.partials):t,e(n,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("search-helper",(function(e){var t=require("hermes-core/type-validator"),a=["q","ss","ct","mt","l","s","w","d","m","hd","b","a","g","e","cm","xel","xeh","xal","xah","xfl","xfh","eui"],s={userId:"user_id",groupId:"group_id",groupPathAlias:"group_path_alias",setId:"set_id",page:"page",text:"text",tags:"tags",tagMode:"tag_mode",sort:"sort",safeSearch:"safe_search",contentType:"content_type",mediaType:"media",license:"license",faves:"faves",contacts:"contacts",getty:"is_getty",commons:"is_commons",marketplace:"marketplace_licensable",minTakenDate:"min_taken_date",maxTakenDate:"max_taken_date",minUploadDate:"min_upload_date",maxUploadDate:"max_upload_date",hasGeo:"has_geo",boundingBox:"bbox",accuracy:"accuracy",woeId:"woe_id",camera:"camera",minExposure:"exif_min_exposure",maxExposure:"exif_max_exposure",minAperture:"exif_min_aperture",maxAperture:"exif_max_aperture",minFocalLength:"exif_min_focallen",maxFocalLength:"exif_max_focallen",excludeUserId:"exclude_user_id",foursquareWoeId:"foursquare_woeid",foursquareVenueId:"foursquare_venueid",slideshowStartId:"jump_to",height:"height",width:"width",dimensionSearchMode:"dimension_search_mode",orientation:"orientation",colorCodes:"color_codes",styles:"styles",similarityId:"similarity_id"},r={relevant:"relevance",recent:"date-posted-desc",interesting:"interestingness-desc",name:"exact-name-match-first",activity:"most-activity",size:"most-members",oldest:"oldest-first",newest:"recent-first",oldestJoined:"age",mostPhotos:"pho",dateUploaded:"date-posted-desc",dateTaken:"date-taken-desc"},n=["s","q","see","m"],o={username:"username",userId:"user_id",sort:"sort"},i=["q","s","m"],c={text:"text",sort:"sort",safeSearch:"safe_search",userId:"user_id",subscriptionTypes:"subscription_types",filterInactive:"filter_inactive_groups"},d={all:"0,1,2,3,4,5,6,7,8,9,10",cc:"1,2,3,4,5,6,9",deriv:"1,2,4,5,9,10",comm:"4,5,6,9,10",commderiv:"4,5,9,10"},l=[s.tags,s.tagMode,s.mediaType,s.minTakenDate,s.maxTakenDate,s.minUploadDate,s.maxUploadDate,s.height,s.width,s.dimensionSearchMode,s.orientation,s.marketplace,s.excludeUserId],u=[s.colorCodes,s.styles],m=[s.sort,s.safeSearch,s.license],p=[s.userId,s.groupId,s.faves,s.contacts,s.commons,"m","w"],h=[s.userId,s.groupId,s.faves,s.contacts,s.safeSearch,s.sort,s.license,s.tags,s.text],f={sort:r.relevant,parse_tags:"1",content_type:"7"};function g(e,t){var a;for(a in d){if(!t&&a===e)return d[a];if(t&&d[a]===e)return a}}e.SearchHelper={API:s,PEOPLE_SEARCH_API:o,GROUPS_SEARCH_API:c,GROUPS_SAFE_SEARCH_SETTINGS:{safe:1,all:2,eighteenPlusOnly:3},API_SORT_OPTIONS:r,API_ORIENTATION_OPTIONS:{portrait:"portrait",square:"square",landscape:"landscape",panorama:"panorama"},LICENSE_TYPE:d,UNIFIED_STATE_PARAMS:{viewAll:"view_all",viewType:"view_type",advanced:"advanced",albums:"album_search"},UNIFIED_ADVANCED_PARAMS:l,UNIFIED_QUICK_FILTER_PARAMS:u,UNIFIED_TOOLBAR_PARAMS:m,SEARCH_SCOPE_PARAMS:p,UNIFIED_DEFAULT_PARAMS:f,decodeContentType:function(e){var t={};switch(parseInt(e,10)){case 1:t.photos=!0;break;case 2:t.screenshots=!0;break;case 3:t.other=!0;break;case 4:t.photos=!0,t.screenshots=!0;break;case 5:t.other=!0,t.screenshots=!0;break;case 6:t.photos=!0,t.other=!0;break;default:t.photos=!0,t.screenshots=!0,t.other=!0}return t},encodeContentType:function(e){var t=0;return!e.photos||e.screenshots||e.other?e.photos||!e.screenshots||e.other?e.photos||e.screenshots||!e.other?e.photos&&e.screenshots&&!e.other?t=4:!e.photos&&e.screenshots&&e.other?t=5:e.photos&&!e.screenshots&&e.other?t=6:e.photos&&e.screenshots&&e.other&&(t=7):t=3:t=2:t=1,t},isParameterlessSearch:function(e){return!(e[s.userId]||e[s.groupId]||e[s.tags]||e[s.text]||e[s.license]||e[s.faves]||e[s.contacts]||e[s.getty]||e[s.commons]||e[s.minTakenDate]||e[s.maxTakenDate]||e[s.minUploadDate]||e[s.maxUploadDate]||e[s.hasGeo]||e[s.boundingBox]||e[s.woeId]||e[s.camera]||e[s.minExposure]||e[s.maxExposure]||e[s.minAperture]||e[s.maxAperture]||e[s.minFocalLength]||e[s.maxFocalLength]||e[s.foursquareWoeId]||e[s.foursquareVenueId]||e[o.username]||e[s.similarityId])},mapRouteParamsToAPI:function(e){var a,r={nsid_or_path_alias:"userId",group_id:"groupId",set_id:"setId",page_number:"page",tag_list:"tags",location:"text",slideshow_start_id:"slideshowStartId"},n={};for(a in r)e[a]&&(n[s[r[a]]]=e[a]);return n[s.groupId]&&!t.nsid(n[s.groupId])&&(n[s.groupPathAlias]=n[s.groupId],delete n[s.groupId]),n},convertLicenseTypeValue:g,mapClassicSearchToAPI:function(n,o){if(!n)return{};var i,c,l,u,m={},p=o.getViewer(),h=n.l,f=n.s,g=n.w,_=n.m,I=n.q;if(n.d&&"string"==typeof n.d&&(l=n.d.split("-")),n.q&&(m[s.text]=n.q),void 0!==n.ss&&(m[s.safeSearch]=parseInt(n.ss,10)+1),void 0!==n.ct&&(m[s.contentType]=parseInt(n.ct,10)+1),void 0!==n.mt&&(m[s.mediaType]=n.mt),n.b&&(m[s.boundingBox]=n.b),n.a&&(m[s.accuracy]=n.a),n.e&&(m[s.woeId]=n.e),n.g&&(m[s.groupId]=n.g),n.cm&&(m[s.camera]=n.cm),void 0!==n.xel&&(m[s.minExposure]=n.xel),void 0!==n.xeh&&(m[s.maxExposure]=n.xeh),void 0!==n.xal&&(m[s.minAperture]=n.xal),void 0!==n.xah&&(m[s.maxAperture]=n.xah),void 0!==n.xfl&&(m[s.minFocalLength]=n.xfl),void 0!==n.xfh&&(m[s.maxFocalLength]=n.xfh),n.eui&&(m[s.excludeUserId]=n.eui),void 0!==h)switch(h){case"cc":case"comm":case"deriv":case"commderiv":m[s.license]=d[h];break;default:(c=parseInt(h,10))>=0&&c<=10&&(m[s.license]=c)}if(f)switch(f){case"rec":m[s.sort]=r.recent;break;case"rel":m[s.sort]=r.relevant;break;case"int":m[s.sort]=r.interesting}if(n.hd&&(m[s.media]="hdvideo"),g&&"string"==typeof g)if(-1!==g.indexOf("faves"))u=g.split("-"),m[s.faves]=1,u.length>1?m[s.userId]=u[1]:p.signedIn&&(m[s.userId]=p.nsid);else if(t.nsid(g))"pool"===_?m[s.groupId]=g:m[s.userId]=g;else switch(g){case"contacts":m[s.contacts]="all";break;case"ff":m[s.contacts]="ff";break;case"getty":m[s.getty]="true";break;case"commons":m[s.commons]="true";break;case"usg":m[s.license]=8}if(l)switch(l[0]){case"taken":l[1]&&(m[s.minTakenDate]=e.flutil.parseYYYYMMDDDatestamp(l[1])/1e3),l[2]&&(m[s.maxTakenDate]=e.flutil.parseYYYYMMDDDatestamp(l[2])/1e3);break;case"posted":l[1]&&(m[s.minUploadDate]=e.flutil.parseYYYYMMDDDatestamp(l[1])/1e3),l[2]&&(m[s.maxUploadDate]=e.flutil.parseYYYYMMDDDatestamp(l[2])/1e3)}if(_&&I&&"tags"===_)delete(m=e.merge(m,this.processTags(I)))[s.text];for(i in n)-1===a.indexOf(i)&&(m[i]=n[i]);return m},mapClassicPeopleSearchToAPI:function(e,t){var a={},s=null,i=t.getViewer();if((e=e||{}).q&&(a[o.username]=e.q),e.s)switch(e.s){case"age":a[o.sort]=r.oldestJoined;break;case"pho":a[o.sort]=r.mostPhotos}for(s in e.see&&"all"===e.see.toString().toLowerCase()&&i.signedIn&&(a[o.userId]=i.nsid),e.m&&(e.m.toString().toLowerCase(),e.m.toString().toLowerCase()),e)-1===n.indexOf(s)&&(a[s]=e[s]);return a},mapClassicGroupSearchToApi:function(e,t){var a,s={},n=null;if(a=(e=e||{}).m&&"discuss"===e.m.toString().toLowerCase(),e.q&&(s[c.text]=e.q),e.s)switch(e.s){case"act":s[c.sort]=a?r.discussionActivity:r.activity;break;case"siz":s[c.sort]=r.size;break;case"age":s[c.sort]=r.newest}for(n in e)-1===i.indexOf(n)&&(s[n]=e[n]);return s},mapAPIParamsToAdvancedSearchQuery:function(e){var t={},a=e[s.userId];return e[s.text]?t.q=e[s.text]:e[s.tags]&&(t.q=e[s.tags]),e[s.faves]?t.w=a?"faves-"+a:"faves":a?t.w=a:"all"===e[s.contacts]?t.w="contacts":"ff"===e[s.contacts]?t.w="ff":"true"===e[s.getty]?t.w="getty":"true"===e[s.commons]?t.w="commons":8===parseInt(e[s.license],10)&&(t.w="usg"),e[s.license]&&(t.l=g(e[s.license],!0)),t},deriveScopeTitle:function(a,r){var n,o=r.getViewer();return a[s.userId]?o&&o.signedIn&&o.nsid===a[s.userId]?a[s.faves]?e.Promise.resolve({intlName:"search.VIEWER_FAVES"}):e.Promise.resolve({intlName:"search.YOUR_PHOTOS"}):(n=t.nsid(a[s.userId])?a[s.userId]:{pathAlias:a[s.userId]},r.getModel("person-models",n).then((function(e){return{intlName:a[s.faves]?"search.FAVES_POSSESSIVE":"search.PHOTOS_POSSESSIVE",name:e.getValue("displayname")}}))):a[s.contacts]?e.Promise.resolve({intlName:"search.FROM_PEOPLE_YOU_FOLLOW"}):a[s.groupId]||a[s.groupPathAlias]?(n=a[s.groupId]?{id:a[s.groupId]}:{pathAlias:a[s.groupPathAlias]},r.getModel("group-info-models",n).then((function(e){return{intlName:"search.IN_GROUP_POOL",name:e.getValue("group").getValue("title")}}))):a[s.faves]?e.Promise.resolve({intlName:"search.VIEWER_FAVES"}):e.Promise.resolve({intlName:"search.EVERYONES_PHOTOS"})},derivePeopleScopeTitle:function(a,r){var n,o=r.getViewer();if(a[s.userId])return o&&o.signedIn&&o.nsid===a[s.userId]?e.Promise.resolve({intlName:"search.PEOPLE_YOU_FOLLOW"}):(n=t.nsid(a[s.userId])?a[s.userId]:{pathAlias:a[s.userId]},r.getModel("person-models",n).then((function(e){return{intlName:"search.CONTACTS_POSSESSIVE",name:e.getValue("username")}})))},deriveGroupsScopeTitle:function(a,r){var n,o=r.getViewer();if(a[s.userId])return o&&o.signedIn&&o.nsid===a[s.userId]?e.Promise.resolve({intlName:"search.YOUR_GROUPS"}):(n=t.nsid(a[s.userId])?a[s.userId]:{pathAlias:a[s.userId]},r.getModel("person-models",n).then((function(e){return{intlName:"search.GROUPS_POSSESSIVE",name:e.getValue("username")}})))},deriveCCLicenseString:function(e){e||(e={});var t=null,a=e[s.license];if(a&&1===a.length)switch(parseInt(a,10)){case 1:t="search.CC_BY_NC_SA";break;case 2:t="search.CC_BY_NC";break;case 3:t="search.CC_BY_NC_ND";break;case 4:t="search.CC_BY";break;case 5:t="search.CC_BY_SA";break;case 6:t="search.CC_BY_ND"}return t?{intlName:t}:null},addParamDefaults:function(e,t){!e[s.license]||e[s.license]!==d.all&&""!==e[s.license]||delete e[s.license]},addGroupsParamDefaults:function(e){},addPeopleParamDefaults:function(e){},clearParams:function(e,t){for(var a in e)-1===t.indexOf(a)&&delete e[a]},clearAdvancedSearchParams:function(e){this.clearParams(e,h)},clearParamsExceptSearchScope:function(e){this.clearParams(e,p)},generateQueryString:function(t){var a=e.clone(t)||{};return delete a.page,delete a.method,delete a.extras,e.QueryString.stringify(a)},convertSafeSearchPrefsToApi:function(t){var a=e.AttributeHelpers.coerceInteger(t);return e.AttributeHelpers.coerceString(a+1)},unescapeParameters:function(t){var a=t[s.groupId],r=t[s.tags],n=t[s.text];YUI.Env.isServer&&(a&&(t[s.groupId]=e.flutil.unescape(a)),r&&(t[s.tags]=e.flutil.unescape(r)),n&&(t[s.text]=e.flutil.unescape(n)))},objectsAreEquivalentToDepth:function(t,a,s){var r,n,o=this;return t===a||!(s<=0)&&(s=s||1,!(!e.Lang.isObject(t)||!e.Lang.isObject(a))&&(r=Object.keys(t),n=Object.keys(a),r.length===n.length&&r.every((function(e){return o.objectsAreEquivalentToDepth(t[e],a[e],s-1)}))))},normalizeTag:function(e){var t;return e&&(t=e.replace(/[\s!-\/:-@[-`]/g,"")),t},processTags:function(e,t){if(!e||"string"!=typeof e)return{};var a,r,n,o={},i=/(["'])(\\?.)*?\1/g,c=/^([,\+]|AND|OR)$/;return a=e.match(i)||[],r=(r=e.replace(i,"").split(/[,\+\s]/)).map((function(e){return e.trim()})).filter((function(e){return e&&!c.test(e)})),n=a.concat(r),o[s.tags]=n.join(","),"any"===t||"all"===t?o[s.tagMode]=t:/[\+\s]OR[\+\s]/.test(e)?(o[s.tagMode]="any",n.length=Math.min(n.length,11)):o[s.tagMode]="all",o}}}),"@VERSION@",{requires:["flutil"],optionalRequires:["hermes-core"]});YUI.add("search-url",(function(e,r){var s,t,a=require("hermes-core/flog")(r),h=/^\/search(?:\/.*)?$/,o=/^bw|blackandwhite$/;function i(e){return"number"==typeof e?e.toString():"boolean"==typeof e?e?"1":"0":"string"==typeof e?e:void 0}s=YUI.Env.isServer?require("querystring").stringify:e.QueryString.stringify,(t=function(r,s,h){var o,p,c,n,l;if(this.appContext=s,"string"==typeof r){if(l=r.split("?"),h?this.searchType=h:(c=-1!==(p=l[0].split("/"))[0].indexOf("http")?3:1,n="/"+p.slice(c).join("/"),this.searchType=this.getSearchTypeFromPathname(n)),l=l.length>1?l[1]:"",this.params={},l)try{l=e.QueryString.parse(l),this.params=e.SearchHelper.mapClassicSearchToAPI(l,s)}catch(e){a.warn("malformed query",{err:e,query:l})}}else this.params=e.merge(r),this.searchType=h;for(o in this.params)this.params.hasOwnProperty(o)&&(this.params[o]=i(this.params[o]));this.params.color_codes&&(this.colors=this.params.color_codes.toString().split(",")),this.searchType||this.setSearchType(t.searchTypes.UNDEFINED)}).prototype.setSearchType=function(r){var s=this.getSearchTerm();return this.searchType=r,this.params=this.validateParams(this.params,this.searchType),this.params=e.merge(this.getDefaultParams(this.searchType),this.params),s&&this.setSearchTerm(s),this},t.prototype.getSearchTypeFromPathname=function(e){switch(e=(e=(e=e||this.pathname).toLowerCase()).split("/").join("")){case"searchpeople":return t.searchTypes.PEOPLE;case"searchgroups":return t.searchTypes.GROUPS;default:return t.searchTypes.PHOTOS}},t.prototype.getPathname=function(){var e="/search/";switch(this.searchType){case t.searchTypes.PEOPLE:e+="people/";break;case t.searchTypes.GROUPS:e+="groups/";break;case t.searchTypes.CLASSIC_GROUPS:e="/search_groups.gne";case t.searchTypes.PHOTOS:}return e},t.prototype.validateParams=function(r,s){var a,h,o,i={};switch(r=e.merge(r),s){case t.searchTypes.PEOPLE:(a=e.merge(e.SearchHelper.PEOPLE_SEARCH_API)).text="text";break;case t.searchTypes.GROUPS:a=e.merge(e.SearchHelper.GROUPS_SEARCH_API);break;case t.searchTypes.PHOTOS:a=e.merge(e.SearchHelper.API,e.SearchHelper.UNIFIED_STATE_PARAMS);break;case t.searchTypes.UNDEFINED:default:return r}if(a)for(h in a)void 0!==r[o=a[h]]&&(i[o]=r[o]);return i},t.prototype.getDefaultParams=function(r){var s={};switch(r){case t.searchTypes.PEOPLE:e.SearchHelper.addPeopleParamDefaults(s);break;case t.searchTypes.GROUPS:e.SearchHelper.addGroupsParamDefaults(s);break;case t.searchTypes.PHOTOS:e.SearchHelper.addParamDefaults(s);case t.searchTypes.UNDEFINED:}return s},t.prototype.getAPIParams=function(){return e.merge(this.params)},t.prototype.getAPIParam=function(e){return this.params[e]},t.prototype.setAPIParam=function(e,r){return this.params[e]=i(r),this},t.prototype.removeAPIParam=function(e){return delete this.params[e],this},t.prototype.removeAllAPIParams=function(){return this.params={},this},t.prototype.getSearchTerm=function(){var r=this.params[this.getSearchTermKey(this.searchType)];return r||(r=this.params[e.SearchHelper.API.tags]),r||""},t.prototype.setSearchTerm=function(r){var s=this.getSearchTermKey(this.searchType);return delete this.params[e.SearchHelper.PEOPLE_SEARCH_API.username],delete this.params[e.SearchHelper.GROUPS_SEARCH_API.text],delete this.params[e.SearchHelper.API.text],delete this.params[e.SearchHelper.API.tags],delete this.params.q,this.params[s]=r,this},t.prototype.getSearchTermKey=function(r){switch(r){case t.searchTypes.PEOPLE:return e.SearchHelper.PEOPLE_SEARCH_API.username;case t.searchTypes.GROUPS:return e.SearchHelper.GROUPS_SEARCH_API.text;case t.searchTypes.PHOTOS:default:return this.params[e.SearchHelper.API.tags]||""===this.params[e.SearchHelper.API.tags]?e.SearchHelper.API.tags:e.SearchHelper.API.text}},t.prototype.removeScope=function(){return e.SearchHelper.SEARCH_SCOPE_PARAMS.forEach(function(e){this.removeAPIParam(e)}.bind(this)),this.removeAPIParam(e.SearchHelper.API.excludeUserId),this},t.prototype.resetToUnified=function(){return this.params[e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll]&&(this.removeAPIParam(e.SearchHelper.API.userId),this.removeAPIParam(e.SearchHelper.API.contacts),this.removeAPIParam(e.SearchHelper.API.groupId),this.removeAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.albums)),this.removeAPIParam(e.SearchHelper.API.similarityId),this.removeAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll),this},t.prototype.hasAdvancedParams=function(r){return Object.keys(this.params).some((function(s){return-1!==e.SearchHelper.UNIFIED_ADVANCED_PARAMS.indexOf(s)||!r&&-1!==e.SearchHelper.UNIFIED_QUICK_FILTER_PARAMS.indexOf(s)||!r&&-1!==e.SearchHelper.UNIFIED_TOOLBAR_PARAMS.indexOf(s)}))},t.prototype.createNewSearch=function(e){return this.setSearchTerm(e),this.removeScope(),this.searchType!==t.searchTypes.UNDEFINED&&this.searchType!==t.searchTypes.PHOTOS||this.resetToUnified(),this},t.prototype.getURL=function(){var e=this.getId(),r=this.getPathname();return e===t.EMPTY_SEARCH_ID?r:r+"?"+e},t.prototype.getId=function(){var r,a={},h=e.SearchHelper.API;for(r in this.params)h[r]?a[h[r]]=this.params[r]:a[r]=this.params[r];return s(a)||t.EMPTY_SEARCH_ID},t.prototype.clone=function(){return new t(this.params,this.appContext,this.searchType)},t.prototype.setMedia=function(r,s){var t;r||(r=!1),s||(s=!1),t=r&&s?"all":r?"photos":"videos",this.setAPIParam(e.SearchHelper.API.mediaType,t)},t.prototype._syncColors=function(){this.colors&&this.colors.length>0?this.params.color_codes=this.colors.join(","):this.removeAPIParam("color_codes")},t.prototype.addColorCode=function(e){if(e&&e.match(o))return this.clearColorCodes(),this.colors=["bw"],void this._syncColors();this.colors&&-1!==this.colors.indexOf("bw")&&(this.colors=[]),this.colors||(this.colors=[]),-1===this.colors.indexOf(e)&&(this.colors.push(e),this._syncColors())},t.prototype.removeColorCode=function(e){var r;this.colors&&-1!==(r=this.colors.indexOf(e))&&(this.colors.splice(r,1),this._syncColors())},t.prototype.clearColorCodes=function(){this.colors=[],this._syncColors()},t.isSearchUrl=function(e){return h.test(e)},t.searchTypes={UNDEFINED:0,PHOTOS:1,PEOPLE:2,GROUPS:3,CLASSIC_GROUPS:4},t.EMPTY_SEARCH_ID="-1",e.SearchUrl=t}),"@VERSION@",{requires:["search-helper","querystring-parse-simple","querystring-stringify-simple"],optionalRequires:["hermes-core"]});YUI.add("photo-lite-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{update:e.PhotoModelHelper.updateEngagement,addReaction:function(t){return e.ModelUpdaters["flickr-reactions-add"].run(t,this.appContext)},removeReaction:function(t){return e.ModelUpdaters["flickr-reactions-remove"].run(t,this.appContext)}},toggleFave:e.PhotoModelHelper.toggleFave,addAsFave:e.PhotoModelHelper.addAsFave,toggleReaction:function(e,t,r){var o="photo-engagement-models",i=this.getValue(e,"reactions")[t].count,a=Object.assign({},this.getValue(e,"reactions")),n=Object.assign({},a[t]);return n.didViewerReact=r,n.count=r?i+1:i-1,a[t]=n,this.setValue(e,"reactions",a),this.name!==o&&this.appContext.getModelRegistry(o).then((function(o){o.exists(e)&&o.toggleReaction(e,t,r)})),this.getValue(e,"reactions")[t]},updateReactionRemote:function(t,r){return e.Promise.resolve({})},getLargestSize:e.PhotoModelHelper.getLargestSize,getSizeToFit:e.PhotoModelHelper.getSizeToFit,getSizeIfExact:e.PhotoModelHelper.getSizeIfExact,isSizeSquare:e.PhotoModelHelper.isSizeSquare,isPhotoSquare:e.PhotoModelHelper.isPhotoSquare,attributes:{owner:{readOnly:!0,isModel:!0,getter:function(e,t){var r=this;return{id:r.getValue(t,"ownerNsid"),getValue:function(e){return"id"===e||"nsid"===e?r.getValue(t,"ownerNsid"):"url"===e?r.getValue(t,"ownerUrl"):r.getValue(t,e)},toJSON:function(){return{id:r.getValue(t,"ownerNsid"),url:r.getValue(t,"ownerUrl"),pathAlias:r.getValue(t,"pathAlias"),username:r.getValue(t,"username"),realname:r.getValue(t,"realname"),displayname:r.getValue(t,"displayname"),nsid:r.getValue(t,"ownerNsid"),ownerUrl:r.getValue(t,"ownerUrl"),isMe:r.getValue(t,"isMe")}},exists:function(e){return!1}}}},pathAlias:e.PersonModelHelper.attributes.pathAlias,username:e.PersonModelHelper.attributes.username,realname:e.PersonModelHelper.attributes.realname,displayname:e.PersonModelHelper.attributes.displayname,nsid:e.PersonModelHelper.attributes.nsid,ownerUrl:e.PersonModelHelper.attributes.url,isMe:e.PersonModelHelper.attributes.isMe,engagement:{readOnly:!0,isModel:!0,getter:function(e,t){var r=this;return{registry:this,getValue:function(e){return r.getValue(t,e)},toJSON:function(){return{ownerNsid:r.getValue(t,"ownerNsid"),isFaved:r.getValue(t,"isFaved"),faveCount:r.getValue(t,"faveCount"),commentCount:r.getValue(t,"commentCount"),canFave:r.getValue(t,"canFave"),reactions:r.getValue(t,"reactions")}},exists:function(e){return!1}}}},ownerNsid:e.PhotoModelHelper.attributes.ownerNsid,isFaved:e.PhotoModelHelper.attributes.isFaved,faveCount:e.PhotoModelHelper.attributes.faveCount,commentCount:e.PhotoModelHelper.attributes.commentCount,canFave:e.PhotoModelHelper.attributes.canFave,title:e.PhotoModelHelper.attributes.title,description:e.PhotoModelHelper.attributes.description,mediaType:e.PhotoModelHelper.attributes.mediaType,license:e.PhotoModelHelper.attributes.license,isVideo:e.PhotoModelHelper.attributes.isVideo,isOwner:e.PhotoModelHelper.attributes.isOwner,sizes:e.PhotoModelHelper.attributes.sizes,descendingSizes:e.PhotoModelHelper.attributes.descendingSizes,ascendingSizes:e.PhotoModelHelper.attributes.ascendingSizes,aspectRatio:e.PhotoModelHelper.attributes.aspectRatio,needsInterstitial:e.PhotoModelHelper.attributes.needsInterstitial,canComment:e.PhotoModelHelper.attributes.canComment,url:e.PhotoModelHelper.attributes.url,rotation:e.PhotoModelHelper.attributes.rotation,similaritySearchURL:e.PhotoModelHelper.attributes.similaritySearchURL,basicSimilaritySearchURL:e.PhotoModelHelper.attributes.basicSimilaritySearchURL,oWidth:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},oHeight:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},isPublic:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isVisibleByFriends:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isVisibleByFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},reactions:{defaultValue:{like:{id:"like",count:5,didViewerReact:!0,canReact:!0},someOtherReaction:{id:"someOtherReaction",count:3,didViewerReact:!1,canReact:!0}},derivedBy:["canFave"],getter:function(e,t){var r=this.getValue(t,"canFave");return e&&e.like&&(e.like.canReact=r,e.like.didViewerReact=!!r&&e.like.didViewerReact),e}}}})}),"@VERSION@",{requires:["flickr-model-registry","photo-model-helper","person-model-helper","flickr-favorites-add-updater","flickr-favorites-remove-updater","photo-models","photo-engagement-models","person-models"]});YUI.add("search-photos-lite-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return t.getPhotoLiteModels=!0,e.ListFetchers["flickr-photos-search"].run(t,this.appContext)}},attributes:{photos:{isCollection:!0,pageFetch:{fetchParams:{getPhotoLiteModels:!0},listFetcher:e.ListFetchers["flickr-photos-search"],listItemIdField:"photoId"}},totalItems:{setter:function(t){return(t=e.AttributeHelpers.coerceInteger(t))<0&&(t=0),t},defaultValue:0},apiParams:{writeOnce:"initOnly"},emptyQuery:{defaultValue:!1}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-photos-search-fetcher","attribute-helpers"]});YUI.add("flickr-photos-search-fetcher",(function(e,o){"use strict";require("hermes-core/flog")(o);e.namespace("ListFetchers")["flickr-photos-search"]={run:function(t,r){var s,a=this,p=t.emptyQuery?{}:this._processParams(e.merge({lang:r.lang||e.config.lang},t),r);return p||(t.emptyQuery=!0),s=[t.emptyQuery?e.Promise.resolve({photos:{photo:[]}}):r.callAPI("flickr.photos.search",p)],s=t.getPhotoLiteModels?s.concat([r.getModelRegistry("search-photos-lite-models"),r.getModelRegistry("photo-lite-models")]):s.concat([r.getModelRegistry("search-photos-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("photo-geo-models")]),e.Promise.all(s).then((function(e){return a._processResponse(e,t)}),e.FetcherErrorLogger(o))},_processParams:function(o,t){var r,s=e.merge(e.SearchHelper.UNIFIED_DEFAULT_PARAMS,{extras:e.APIHelper.request[o.getPhotoLiteModels?"getRebootPhotoLiteExtras":"getRebootPhotoExtras"](),per_page:o.perPage||50,page:o.page||"1",lang:o.lang});return o.fetchGeo&&(s.extras+=",geo"),o.additionalExtras&&(s.extras+=","+o.additionalExtras.join(",")),r=e.merge(s,o.apiParams||{}),o.privacyFilter&&(r.privacy_filter=o.privacyFilter),YUI.Env.isServer&&e.SearchHelper.unescapeParameters(r),e.SearchHelper.isParameterlessSearch(r)?null:r},_processResponse:function(o,t){var r,s,a,p,l,i,h=o[0],n=o[1],d=o[2],g={id:t.id||e.SearchUrl.EMPTY_SEARCH_ID,apiParams:{},emptyQuery:!!t.emptyQuery,photos:[]};if(t.id&&t.id!==e.SearchUrl.EMPTY_SEARCH_ID&&(g.apiParams=e.QueryString.parse(t.id)),!t.id)throw new ReferenceError("No `id` provided by request.");if(!h.photos||!h.photos.photo){var c=new Error("No `photos.photo` property returned by search API v1.");throw c.fatal=!0,c}var m=h.photos.photo;return t.getPhotoLiteModels?a=m.map((function(o){return l=e.APIHelper.response.parsePhotoLite(o),d.addOrUpdate(l)})):(a=e.APIHelper.response.parsePhotos({photos:h.photos.photo,photoModelRegistry:d,personModelRegistry:o[3],photoEngagementModelRegistry:o[4],photoStatsModelRegistry:o[5]}),t.fetchGeo&&(r=o[6],h.photos.photo.forEach((function(e){p=void 0!==e.latitude?{id:e.id,hasGeo:!0,latitude:e.latitude,longitude:e.longitude}:{id:e.id,hasGeo:!1},r.addOrUpdate(p)})))),g.photos={perPage:h.photos.perpage,page:h.photos.page,pageContent:a,totalItems:parseInt(h.photos.total,10),totalPages:h.photos.pages/t.perPage},h.photos.maxAllowedResults&&(g.photos.totalItems=Math.min(h.photos.maxAllowedResults,parseInt(h.photos.total,10))),h.photos.maxAllowedPages&&(g.photos.totalPages=Math.min(h.photos.maxAllowedPages,h.photos.pages)),g.totalItems=parseInt(h.photos.total,10),n.exists(g.id)?(s=n.getValue(g.id,"photos").getList(),i=s.filter((function(e){return!!e})).reduce((function(e,o){return e[o.id]=!0,e}),{}),g.photos.pageContent=g.photos.pageContent.filter((function(e){return!i[e.id]})),1===g.photos.page&&(g.photos.forceAppend=!0),n.addOrUpdate(g)):n.add(g),a}}}),"@VERSION@",{requires:["flickr-promise","search-helper","search-url","api-helper","querystring-parse-simple"],optionalRequires:["superagent","hermes-core"],optional:["search-photos-models","search-photos-lite-models","photo-models","photo-lite-models","person-models","photo-engagement-models","photo-stats-models","photo-geo-models"]});YUI.add("search-photos-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-photos-search"].run(t,this.appContext)}},attributes:{photos:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-photos-search"],listItemIdField:"photoId"}},totalItems:{setter:function(t){return(t=e.AttributeHelpers.coerceInteger(t))<0&&(t=0),t},defaultValue:0},apiParams:{writeOnce:"initOnly"},emptyQuery:{defaultValue:!1}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-photos-search-fetcher"]});