YUI.add("modal-droparound-helper",(function(e,o){require("hermes-core/flog")(o);e.ModalDroparoundHelper=function(o,r){var i=this,n={},t={};return this.setParams=function(e){this.params=e,e.useViewportType=void 0===e.useViewportType||e.useViewportType,e.configs=Object.assign({common:{},droparound:{},modal:{}},e.configs),n=Object.assign({appContext:o,dismissOnOverlayClick:!0,showDropArrow:!0,newReposition:!0,autoSizeToContent:!0,anchorOffsetVertical:0,contentPadding:0,preventPageScrollOnScroll:!0,useDefaultKeyboardNavigation:!1},e.configs.common,e.configs.droparound),t=Object.assign({appContext:o,showCancelButton:!1,showActionButton:!1,showCancelX:!1,dismissOnOverlayClick:!0,hideModalOverlay:!0,showHeader:!1,showFooter:!1,contentPadding:0,focusOnFirstTabPress:!1},e.configs.common,e.configs.modal),e.containerType=this.calculateContainerType()},this.show=function(){return"droparound"===this.params.containerType&&n.anchorElement?this.showDroparound(n):this.showModal(t),this.wrapperView},this.close=function(){this.wrapperView&&this.wrapperView.close()},this.showModal=function(o){this.wrapperView=new e.Views.FluidModal(o),this.wrapperView.show(),this.wrapperView.on("close",(function(){i.fire("close")}))},this.showDroparound=function(o){this.wrapperView=new e.Views.FluidDroparound(o),this.wrapperView.show(),this.wrapperView.on("closeDroparound",(function(){i.fire("close")}))},this.calculateContainerType=function(){return this.params.useViewportType&&(this.params.containerType=o.viewportData.getWidth()>700?"droparound":"modal"),this.params.containerType},this.setParams(r),this},e.augment(e.ModalDroparoundHelper,e.EventTarget)}),"@VERSION@",{requires:["event-custom","fluid-modal-view","fluid-droparound-view"],optionalRequires:["hermes-core"]});YUI.add("curation-helper",(function(e,o){require("hermes-core/flog")(o),e.mix({langBundles:["prints"]},e.Localizable);e.CurationHelper=function(o,i){var s=this;return this.showAddToCuration=function(i){var r,t,a=i.photoId,n=i.customConfig,u=i.anchorNode,l=void 0===i.useViewportType||i.useViewportType,w=i.containerType,c=void 0===i.showAlbums||i.showAlbums,d=void 0!==i.showGalleries&&i.showGalleries,h=void 0===i.showGroups||i.showGroups,p=i.initialTab,m={};return p||(p=c?"album":"gallery"),r=n||{photoId:a,initialTab:p,showAlbums:c,showGalleries:d,showGroups:h,inlineGroupCreation:!1,dismissOnSelect:!0,dismissOnCreate:!0},m={useViewportType:l,containerType:w,configs:{droparound:{preferTop:!0,width:400,anchorElement:u,keyboardAnchorElement:u}}},"droparound"===(t=new e.ModalDroparoundHelper(o,m)).params.containerType||(r.inlineGroupCreation=!0,r.useLargeLayout=!0,r.dismissOnSelect=!1,r.dismissOnCreate=!1),this.curateView=new e.Views["add-to-stuff-view"](r),m.configs.common.subview=this.curateView,t.setParams(m),this.curateWrapperView=t.show(),t.on("close",(function(e){s.fire("curateDroparoundClosed")})),this.curateWrapperView},this.showCreationModal=function(i){var s=i.viewName,r=i.customConfig,t=i.overlayClassList,a={appContext:o};a=Object.assign(a,r),this.creationView=new e.Views[s](a),this.creationModal=new e.Views.FluidModal({appContext:o,subview:this.creationView,dismissOnOverlayClick:!0,showHeader:!1,showFooter:!1,showButtons:!1,showCancelButton:!1,showActionButton:!1,showCancelX:!1,contentPadding:0,overlayClassList:t}),this.creationModal.show()},this},e.augment(e.CurationHelper,e.EventTarget)}),"@VERSION@",{requires:["event-custom","add-to-stuff-view","album-creation-view","gallery-creation-view","group-creation-view","modal-droparound-helper"],optionalRequires:["hermes-core"]});YUI.add("photo-list-photo-interaction-view",(function(e,t){var i=require("hermes-core/type-validator"),o=require("hermes-core/flog")(t),n={faveClickArea:".fave-area",commentClickArea:".comment-area",removeFaveTool:"remove-fave",removePoolTool:"remove-group-pool",removeShowCasePhoto:"remove-showcase-photo",removePhotosOfYou:"remove-photosof-you",scotchTool:"scotch-photo"};e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){var t=this.appContext.getViewer();return e.subviewParams={"like-engagement-item-view":{photoId:this.get("id"),showCount:!0,size:"small",isPadded:!1,theme:"light",engagementModelName:"photo-lite-models"}},""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),t.signedIn&&e.nsid===t.nsid||this.set("viewingSelf",!1),e.photoPageUrl&&this.set("photoPageUrl",e.photoPageUrl),this.params=e,this.signedIn=t.signedIn,void 0!==e.showCurate?this.showCurate=e.showCurate:this.showCurate=this.signedIn,this},subviewConfig:{"like-engagement-item-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!this.appContext.flipper.isFlipped("enable-likes")}}},loadState:function(){var t=[],i=this.get("listModelParams");return t.push(this.appContext.getModel(this.get("engagementModelName"),this.get("id"))),i&&t.push(this.appContext.getModel(i.registryName,i.modelIdOrAttributes)),e.Promise.all(t).then(function(e){var t=e[0],i=e[1];this.set("engagement",t),this.extraFunctionality={moreMenuItems:[]},this.params.removeOwnFaves?this.get("model").getValue("isOwner")&&!this.get("viewingSelf")&&(this.extraFunctionality.removeToolClass=n.removeFaveTool):this.params.removePoolPhoto?(this.get("model").getValue("isOwner")||i&&(i.getValue("group").getValue("isAdmin")||i.getValue("group").getValue("isModerator")))&&(this.extraFunctionality.removeToolClass=n.removePoolTool):this.params.scotch?this.extraFunctionality.removeToolClass=n.scotchTool:this.params.removeShowCasePhoto?this.get("model").getValue("isOwner")&&this.get("viewingSelf")&&(this.extraFunctionality.removeToolClass=n.removeShowCasePhoto):this.params.removePhotosOfYou&&this.get("viewingSelf")&&(this.extraFunctionality.removeToolClass=n.removePhotosOfYou),this.params.excludePeople&&this.extraFunctionality.moreMenuItems.push("exclude-people"),this.params.banUser&&i&&(i.getValue("group").getValue("isAdmin")||i.getValue("group").getValue("isModerator"))&&this.extraFunctionality.moreMenuItems.push("ban-user"),this.params.removeUser&&i&&(i.getValue("group").getValue("isAdmin")||i.getValue("group").getValue("isModerator"))&&this.extraFunctionality.moreMenuItems.push("remove-user"),this.params.searchSimilar&&this.extraFunctionality.moreMenuItems.push("search-similar"),this.params.searchSimilarWithTerm&&this.extraFunctionality.moreMenuItems.push("search-similar-with-term"),this.params.bigScotch&&(this.extraFunctionality.bigScotchTitle=this.godMessage({intlName:"explore.DO_BIG_SCOTCH"})),this.extraFunctionality.moreMenuItems=this.extraFunctionality.moreMenuItems.join(",")}.bind(this))},buildContainer:function(t){var i=this.get("engagement"),o=i.getValue("faveCount"),n=i.getValue("isFaved"),a=i.getValue("canFave"),s=i.getValue("commentCount");return t=t||{},o=e.IntlNumber.format(o,this.appContext.lang,1),s=e.IntlNumber.format(s,this.appContext.lang,1),t.photo=this.get("model").toJSON(),t.photoPageUrl=this.get("photoPageUrl"),t.faveCount=o,t.isFaved=n,t.canFave=a,t.commentCount=s,t.displayCurate=this.showCurate,t.hasExtraFunctionality=Object.keys(this.extraFunctionality).length>0,t.removeToolClass=this.extraFunctionality.removeToolClass,t.moreMenuItems=this.extraFunctionality.moreMenuItems,t.bigScotchTitle=this.extraFunctionality.bigScotchTitle,this.setContainerWithTemplate("photo-list-photo-interaction",t),this},activate:function(){var t=this,i=(this.appContext.getViewer(),this.get("engagement")),o=this.get("container");return this.infoBar=o.one(".interaction-bar"),this.detailsNode=this.infoBar.one(".text"),this.infoBarEngagement=this.infoBar.one(".engagement"),this.faveNode=this.infoBarEngagement.one(".engagement-item.fave"),this.commentNode=this.infoBarEngagement.one(".engagement-item.comment"),this.appContext.flipper.isFlipped("enable-likes")&&(this.likeNode=this.infoBarEngagement.one(".engagement-item.like"),this.likeView=this.subviews["like-engagement-item-view"],this.likeView.isActivated?(this.isActive=!0,this.fire("activated")):this.likeView.on("activated",(function(){t.isActive=!0,t.fire("activated")}))),this.curateNode=this.infoBar.one(".engagement-item.curate"),this.curateNode&&this.registerEventHandler(this.curateNode.on(["click","keydown"],this.handleCurateClick.bind(this))),this.faveNode&&(this.faveCountNode=this.faveNode.one(".engagement-count"),this.registerEventHandler(this.faveNode.on(["click","keydown"],this.handleFaveClick.bind(this)))),this.commentNode&&(this.commentIconNode=this.commentNode.one(".engagement-icon"),this.commentTextNode=this.commentNode.one(".engagement-count"),this.registerEventHandler(this.commentNode.on(["click","keydown"],this.handleCommentClick.bind(this)))),this.registerEventHandler(i.on("valuesChanged",this.handleEngagementModelValuesChanged.bind(this))),this.registerEventHandler(e.on("resize",e.betterThrottle(this.updateBreakpoints.bind(this),500,this,!0))),this.appContext.flipper.isFlipped("enable-likes")||(t.isActive=!0,t.fire("activated")),this},handleFaveClick:function(e){var t,i,n,a,s;if("click"===e.type||13===e.keyCode||32===e.keyCode){if(t=this,i=e.currentTarget,n=i.one(".engagement-count"),s=this.appContext.getViewer(),e.halt(),this.faveNode.hasClass("can-not-fave"))return;if(!this.signedIn)return void this.showSignUpAndFaveModal();this.isFaving||(this.isFaving=!0,this.get("engagement").toggleFave(),a=this.get("engagement").getValue("faveCount"),i.toggleClass("faved",this.get("engagement").getValue("isFaved")),n.toggleClass("empty",0===a),n&&a>0?n.set("text",a):n.set("text",""),this.get("engagement").remoteUpdate().then(function(){this.appContext.getModelRegistry("favorite-models").then((function(e){e.proxy(s.nsid).getValue("photoPageList").remove(t.get("model"))})),this.isFaving=!1}.bind(this),function(e){3!==e.code&&(this.get("engagement").toggleFave(),i.toggleClass("faved",this.get("engagement").getValue("isFaved")),n&&(n.set("text",a),n.toggleClass("empty",0===a))),o.error("Error faving photo",{err:e}),this.isFaving=!1}.bind(this)))}},handleCommentClick:function(t){var i,o,n=this;"click"!==t.type&&13!==t.keyCode&&32!==t.keyCode||(t.halt(),i=new e.Views["photo-comments-view"]({appContext:this.appContext,photoId:this.get("model").getValue("id"),isScrollable:!0}),(o=new e.ModalDroparoundHelper(this.appContext,{configs:{common:{subview:i},droparound:{preferTop:!0,width:400,height:400,anchorElement:this.commentIconNode,keyboardAnchorElement:this.commentIconNode},modal:{height:550,flexLayout:!0}}})).show(),n.registerEventHandler(e.on("addComment:showingSignupModal",(function(){o.close()}))),o.on("close",(function(){n.commentNode.removeClass("active"),n.fire("hoverActionClosed")})),this.commentNode.addClass("active"),this.fire("hoverActionOpened"))},showSignUpAndFaveModal:function(){var t,i=this.intlMessage({intlName:"fave-view.SIGN_IN_BEFORE_FAVE_TITLE"}),o=this.intlMessage({intlName:"fave-view.JOIN_FLICKR_AND_FAVE"}),n=this.get("engagement"),a=n.getValue("id"),s=e.url(e.URLHelper.getPhotoPage({photoId:a,pathAlias:n.getValue("ownerNsid")}));(t=new e.Views.SignUpModal({appContext:this.appContext,signUpHeaderClass:"signup-fave",signUpTitle:i,signUpMessage:o,beaconPrefix:"fave"})).on("signUpClick",(function(t){e.SigninHelper.signUpPendingFave({id:a},{postLoginUrl:s})})),t.on("signInClick",(function(t){e.SigninHelper.addPendingFave({id:a},{postLoginUrl:s})})),t.show()},showSignUpAndCommentModal:function(){var t,i,o=this.intlMessage({intlName:"photo-page-scrappy.SIGNUP_AND_COMMENT_TITLE"}),n=this.intlMessage({intlName:"photo-page-scrappy.SIGNUP_AND_COMMENT_MESSAGE"}),a=this.get("engagement");e.rapidTracker.beacon(this.name,"commentIconClick"),i=e.url(e.URLHelper.getPhotoPage({photoId:a.getValue("id"),pathAlias:a.getValue("ownerNsid")})),(t=new e.Views.SignUpModal({appContext:this.appContext,signUpHeaderClass:"signup-comment",signUpTitle:o,signUpMessage:n,beaconPrefix:"comment"})).on("signUpClick",(function(t){e.SigninHelper._redirectToSignUp("comment",{postLoginUrl:i})})),t.on("signInClick",(function(t){e.SigninHelper._redirectToSignin("comment",{postLoginUrl:i})})),t.show()},handleEngagementModelValuesChanged:function(t){var i;t.commentCount&&(i=t.commentCount.newVal,this.commentTextNode.set("text",e.IntlNumber.format(i,this.appContext.lang,1)),this.commentTextNode.toggleClass("hidden",0===i),this.updateBreakpoints()),void 0===t.faveCount&&void 0===t.isFaved&&void 0===t.canFave||this.updateBreakpoints()},handleCurateClick:function(e){"click"!==e.type&&13!==e.keyCode&&32!==e.keyCode||(e.halt(),this.showAddToCuration())},showAddToCuration:function(){var t=this,i=this.get("model").getValue("isOwner"),o=new e.CurationHelper(this.appContext);"fluid-droparound-view"===o.showAddToCuration({photoId:this.get("model").getValue("id"),showAlbums:i,showGalleries:!i,anchorNode:this.curateNode}).name&&(t.fire("hoverActionOpened"),o.on("curateDroparoundClosed",(function(){t.fire("hoverActionClosed")})))},updateBreakpoints:function(){var e,t=0;this.isActive&&(0===(e=this.infoBar.get("clientWidth"))||e>160||(this.infoBar.addClass("invisible"),this.infoBar.removeClass("narrow"),this.detailsNode.removeClass("hidden"),this.commentNode.removeClass("hidden"),this.curateNode&&this.curateNode.removeClass("hidden"),this.appContext.flipper.isFlipped("enable-likes")?this.likeNode&&(this.likeNode.removeClass("hidden"),this.likeNode.removeClass("last"),this.likeView.showCountNode(!0)):this.faveNode&&(this.faveNode.removeClass("hidden"),this.faveNode.removeClass("last"),this.faveCountNode.removeClass("hidden")),this.detailsNode.get("clientWidth")<=10&&(this.infoBar.addClass("narrow"),this.detailsNode.addClass("hidden")),this.infoBar.get("clientWidth")<this.infoBarEngagement.get("clientWidth")+24&&(this.commentNode.addClass("hidden"),this.appContext.flipper.isFlipped("enable-likes")?(this.curateNode?t=this.curateNode.get("clientWidth"):this.likeNode.addClass("last"),this.infoBar.get("clientWidth")<t+this.likeNode.get("clientWidth")+24&&this.likeView.showCountNode(!1),this.curateNode&&this.infoBar.get("clientWidth")<this.infoBarEngagement.get("clientWidth")+24&&(this.curateNode.addClass("hidden"),this.likeNode.addClass("last"))):(this.curateNode?t=this.curateNode.get("clientWidth"):this.faveNode.addClass("last"),this.faveCountNode&&this.infoBar.get("clientWidth")<t+this.faveNode.get("clientWidth")+24&&this.faveCountNode.addClass("hidden"),this.curateNode&&this.infoBar.get("clientWidth")<this.infoBarEngagement.get("clientWidth")+24&&(this.curateNode.addClass("hidden"),this.faveNode.addClass("last")))),this.infoBar.removeClass("invisible")))},destructor:function(){}},{ATTRS:{id:{writeOnce:"initOnly",validator:function(e,t){return i.photoId(e)}},model:{writeOnce:"initOnly"},listModelParams:{writeOnce:"initOnly"},photoPageUrl:{writeOnce:"initOnly"},engagement:{value:null},viewingSelf:{value:!0},engagementModelName:{writeOnce:"initOnly",value:null,validator:function(t,i){return e.AttributeHelpers.validateString(t)}},layoutWidth:{validator:function(t,i){return e.AttributeHelpers.validateFloat(t)},setter:function(t){return e.AttributeHelpers.coerceFloat(t)||void 0},defaultFn:function(e){return 0}},isFaving:{value:!1,validator:function(t,i){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}}}})}),"@VERSION@",{requires:["flickr-view","hermes-template-photo-list-photo-interaction","attribute-helpers","fluid-modal-view","fluid-droparound-view","add-to-stuff-view","photo-comments-view","like-engagement-item-view","url","intl-number","curation-helper"],optionalRequires:["fluid","hermes-core"],langBundles:["fave-view","common","photo-page-scrappy","comments"]});YUI.add("hermes-lang-fave-view",(function(e,t){e.Intl.add("hermes/fave-view","en-US",{COULDNT_FAVE:[{type:0,value:"We couldn’t fave at this time"}],SIGN_IN_TO_FAVE:[{type:0,value:"You must be signed in to fave. Please sign in now."}],LOADING_FAVES:[{type:0,value:"Loading Faves..."}],UNFAVE_PHOTO:[{type:0,value:"Unfave this photo"}],FAVE_PHOTO:[{type:0,value:"Fave this photo"}],WHO_FAVED:[{type:0,value:"Who faved this photo"}],SIGN_IN_BEFORE_FAVE_TITLE:[{type:0,value:"You found a photo to fave!"}],SIGN_IN_BEFORE_FAVE_MESSAGE:[{type:0,value:"That’s great. Just sign in to fave it."}],SIGN_IN_AND_FAVE:[{type:0,value:"Sign in and fave"}],JOIN_FLICKR_AND_FAVE:[{type:0,value:"Join Flickr to add this photo to your favorites."}]})}),"@VERSION@",{requires:["intl"]});YUI.add("hermes-template-follow",(function(n,l){var t=n.Template.Handlebars.revive({1:function(n,l,t,o,e){var r,a=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(r=a(t,"if").call(null!=l?l:n.nullContext||{},null!=l?a(l,"showNoButton"):l,{name:"if",hash:{},fn:n.program(2,e,0),inverse:n.program(4,e,0),data:e,loc:{start:{line:2,column:1},end:{line:14,column:8}}}))?r:""},2:function(n,l,t,o,e){return""},4:function(n,l,t,o,e){var r,a=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(r=a(t,"if").call(null!=l?l:n.nullContext||{},null!=l?a(l,"showUnblockButton"):l,{name:"if",hash:{},fn:n.program(5,e,0),inverse:n.program(7,e,0),data:e,loc:{start:{line:5,column:2},end:{line:13,column:9}}}))?r:""},5:function(n,l,t,o,e){var r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t\t\t<button class='follow alt'>"+n.escapeExpression((r(t,"intlMessage")||l&&r(l,"intlMessage")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},{name:"intlMessage",hash:{intlName:"common.UNBLOCK"},data:e,loc:{start:{line:6,column:30},end:{line:6,column:71}}}))+"</button>\n"},7:function(n,l,t,o,e){var r,a=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(r=a(t,"if").call(null!=l?l:n.nullContext||{},null!=l?a(l,"showFollowingButton"):l,{name:"if",hash:{},fn:n.program(8,e,0),inverse:n.program(10,e,0),data:e,loc:{start:{line:8,column:3},end:{line:12,column:10}}}))?r:""},8:function(n,l,t,o,e){return'\t\t\t\t<button class="follow is-following mini"><span class="drop-icon">▾</span></button>\n'},10:function(n,l,t,o,e){return'\t\t\t\t<button class="follow mini"></button>\n'},12:function(n,l,t,o,e){var r,a=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(r=a(t,"if").call(null!=l?l:n.nullContext||{},null!=l?a(l,"isFluid"):l,{name:"if",hash:{},fn:n.program(13,e,0),inverse:n.program(23,e,0),data:e,loc:{start:{line:16,column:1},end:{line:46,column:8}}}))?r:""},13:function(n,l,t,o,e){var r,a=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(r=a(t,"if").call(null!=l?l:n.nullContext||{},null!=l?a(l,"showNoButton"):l,{name:"if",hash:{},fn:n.program(2,e,0),inverse:n.program(14,e,0),data:e,loc:{start:{line:17,column:2},end:{line:29,column:9}}}))?r:""},14:function(n,l,t,o,e){var r,a=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(r=a(t,"if").call(null!=l?l:n.nullContext||{},null!=l?a(l,"showUnblockButton"):l,{name:"if",hash:{},fn:n.program(15,e,0),inverse:n.program(17,e,0),data:e,loc:{start:{line:20,column:3},end:{line:28,column:10}}}))?r:""},15:function(n,l,t,o,e){var r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t\t\t\t<button class='follow alt'>"+n.escapeExpression((r(t,"intlMessage")||l&&r(l,"intlMessage")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},{name:"intlMessage",hash:{intlName:"common.UNBLOCK"},data:e,loc:{start:{line:21,column:31},end:{line:21,column:72}}}))+"</button>\n"},17:function(n,l,t,o,e){var r,a=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(r=a(t,"if").call(null!=l?l:n.nullContext||{},null!=l?a(l,"showFollowingButton"):l,{name:"if",hash:{},fn:n.program(18,e,0),inverse:n.program(21,e,0),data:e,loc:{start:{line:23,column:4},end:{line:27,column:11}}}))?r:""},18:function(n,l,t,o,e){var r,a=null!=l?l:n.nullContext||{},u=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t\t\t\t<button class="follow is-following '+(null!=(r=u(t,"if").call(a,null!=l?u(l,"isOnDark"):l,{name:"if",hash:{},fn:n.program(19,e,0),inverse:n.noop,data:e,loc:{start:{line:24,column:40},end:{line:24,column:68}}}))?r:"")+'">'+n.escapeExpression((u(t,"intlMessage")||l&&u(l,"intlMessage")||n.hooks.helperMissing).call(a,{name:"intlMessage",hash:{intlName:null!=l?u(l,"followingIntlKey"):l},data:e,loc:{start:{line:24,column:70},end:{line:24,column:111}}}))+'<span class="drop-icon">▾</span></button>\n'},19:function(n,l,t,o,e){return"white"},21:function(n,l,t,o,e){var r,a=null!=l?l:n.nullContext||{},u=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t\t\t\t<button class="follow '+(null!=(r=u(t,"if").call(a,null!=l?u(l,"isOnDark"):l,{name:"if",hash:{},fn:n.program(19,e,0),inverse:n.noop,data:e,loc:{start:{line:26,column:27},end:{line:26,column:55}}}))?r:"")+'">'+n.escapeExpression((u(t,"intlMessage")||l&&u(l,"intlMessage")||n.hooks.helperMissing).call(a,{name:"intlMessage",hash:{intlName:null!=l?u(l,"followIntlKey"):l},data:e,loc:{start:{line:26,column:57},end:{line:26,column:95}}}))+"</button>\n"},23:function(n,l,t,o,e){var r,a=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(r=a(t,"if").call(null!=l?l:n.nullContext||{},null!=l?a(l,"showNoButton"):l,{name:"if",hash:{},fn:n.program(2,e,0),inverse:n.program(24,e,0),data:e,loc:{start:{line:31,column:2},end:{line:45,column:9}}}))?r:""},24:function(n,l,t,o,e){var r,a=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t\t<span class="relationship">\n'+(null!=(r=a(t,"if").call(null!=l?l:n.nullContext||{},null!=l?a(l,"showUnblockButton"):l,{name:"if",hash:{},fn:n.program(2,e,0),inverse:n.program(25,e,0),data:e,loc:{start:{line:35,column:4},end:{line:43,column:11}}}))?r:"")+"\t\t\t</span>\n"},25:function(n,l,t,o,e){var r,a=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(r=a(t,"if").call(null!=l?l:n.nullContext||{},null!=l?a(l,"showFollowingButton"):l,{name:"if",hash:{},fn:n.program(26,e,0),inverse:n.program(28,e,0),data:e,loc:{start:{line:38,column:5},end:{line:42,column:12}}}))?r:""},26:function(n,l,t,o,e){var r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t\t\t\t\t\t<button class='unfluid follow is-following ui-button ui-button-icon ui-button-transparent ui-button-dropdown'><span>"+n.escapeExpression((r(t,"intlMessage")||l&&r(l,"intlMessage")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},{name:"intlMessage",hash:{intlName:"common.FOLLOWING"},data:e,loc:{start:{line:39,column:122},end:{line:39,column:165}}}))+"</span></button>\n"},28:function(n,l,t,o,e){var r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t\t\t\t\t\t<button class='unfluid follow ui-button ui-button-icon'><span>"+n.escapeExpression((r(t,"intlMessage")||l&&r(l,"intlMessage")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},{name:"intlMessage",hash:{intlName:"common.FOLLOW"},data:e,loc:{start:{line:41,column:68},end:{line:41,column:108}}}))+"</span></button>\n"},compiler:[8,">= 4.3.0"],main:function(n,l,t,o,e){var r,a=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(r=a(t,"if").call(null!=l?l:n.nullContext||{},null!=l?a(l,"isOnMobile"):l,{name:"if",hash:{},fn:n.program(1,e,0),inverse:n.program(12,e,0),data:e,loc:{start:{line:1,column:0},end:{line:47,column:7}}}))?r:""},useData:!0}),o={};n.Array.each([],(function(l){var t=n.Template.get("hermes/"+l);t&&(o[l]=t)})),n.Template.register("hermes/follow",(function(l,e){return(e=e||{}).partials=e.partials?n.merge(o,e.partials):o,t(l,e)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-following-dropdown",(function(n,e){var l=n.Template.Handlebars.revive({1:function(n,e,l,t,a){return'\t\t\t<label class = "checked">\n\t\t\t\t<input type="checkbox" checked="checked" id="friend-checkbox" />\n'},3:function(n,e,l,t,a){return'\t\t\t<label>\n\t\t\t\t<input type="checkbox" id="friend-checkbox" />\n'},5:function(n,e,l,t,a){return'\t\t\t<label class="checked">\n\t\t\t\t<input type="checkbox" checked="checked" id="family-checkbox" />\n'},7:function(n,e,l,t,a){return'\t\t\t<label>\n\t\t\t\t<input type="checkbox" id="family-checkbox" />\n'},9:function(n,e,l,t,a){var i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\t\t\t<button class="follow unfollow">'+n.escapeExpression((i(l,"intlMessage")||e&&i(e,"intlMessage")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},{name:"intlMessage",hash:{intlName:"common.UNFOLLOW"},data:a,loc:{start:{line:27,column:35},end:{line:27,column:77}}}))+"</button>\n"},11:function(n,e,l,t,a){var i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\t\t\t<a href="#"><i class="ui-icon-tiny-unfollow"></i> '+n.escapeExpression((i(l,"intlMessage")||e&&i(e,"intlMessage")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},{name:"intlMessage",hash:{intlName:"common.UNFOLLOW"},data:a,loc:{start:{line:29,column:53},end:{line:29,column:95}}}))+"</a>\n"},compiler:[8,">= 4.3.0"],main:function(n,e,l,t,a){var i,o=null!=e?e:n.nullContext||{},r=n.hooks.helperMissing,s=n.escapeExpression,c=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<ul>\n\t<li class="following-friend">\n'+(null!=(i=c(l,"if").call(o,null!=e?c(e,"isFriend"):e,{name:"if",hash:{},fn:n.program(1,a,0),inverse:n.program(3,a,0),data:a,loc:{start:{line:3,column:2},end:{line:9,column:9}}}))?i:"")+"\t\t\t"+s((c(l,"intlMessage")||e&&c(e,"intlMessage")||r).call(o,{name:"intlMessage",hash:{intlName:"common.FRIEND"},data:a,loc:{start:{line:10,column:3},end:{line:10,column:43}}}))+'\n\t\t</label>\n\t</li>\n\t<li class="following-family">\n'+(null!=(i=c(l,"if").call(o,null!=e?c(e,"isFamily"):e,{name:"if",hash:{},fn:n.program(5,a,0),inverse:n.program(7,a,0),data:a,loc:{start:{line:14,column:2},end:{line:20,column:9}}}))?i:"")+"\t\t\t"+s((c(l,"intlMessage")||e&&c(e,"intlMessage")||r).call(o,{name:"intlMessage",hash:{intlName:"common.FAMILY"},data:a,loc:{start:{line:21,column:3},end:{line:21,column:43}}}))+'\n\t\t</label>\n\t</li>\n\t<li class="divider"></li>\n\t<li class="following-unfollow">\n'+(null!=(i=c(l,"if").call(o,null!=e?c(e,"isFluid"):e,{name:"if",hash:{},fn:n.program(9,a,0),inverse:n.program(11,a,0),data:a,loc:{start:{line:26,column:2},end:{line:30,column:9}}}))?i:"")+"\t</li>\n</ul>"},useData:!0}),t={};n.Array.each([],(function(e){var l=n.Template.get("hermes/"+e);l&&(t[e]=l)})),n.Template.register("hermes/following-dropdown",(function(e,a){return(a=a||{}).partials=a.partials?n.merge(t,a.partials):t,l(e,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("relationship-menu-view",(function(i,e){var n=require("hermes-core/flog")(e);i.FlickrView.create(this.name,i.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(i){return this.nsid=i.nsid,this.pathAlias=i.pathAlias,this.disableRefreshOnRelationshipChange=i.disableRefreshOnRelationshipChange,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},loadState:function(){var i=this,e=i.nsid||{pathAlias:i.pathAlias};return i.appContext.getModel("person-relationship-models",e).then((function(e){i.relationship=e,i.nsid=i.nsid||e.id}))},buildContainer:function(){return this.setContainerWithTemplate("following-dropdown",{isFriend:this.relationship.getValue("isFriend"),isFamily:this.relationship.getValue("isFamily"),isFluid:!0}),this},activate:function(){var i=this.get("container"),e=this;return this.relationship&&this.registerEventHandler(this.relationship.on("valuesChanged",(function(){e.buildContainer()}))),this.registerEventHandler(i.delegate("click",(function(i){e.handleUnfollowClick(i)}),".following-unfollow")),this.registerEventHandler(i.delegate("change",(function(i){e.handleFriendChange(i)}),".following-friend input")),this.registerEventHandler(i.delegate("change",(function(i){e.handleFamilyChange(i)}),".following-family input")),this},handleUnfollowClick:function(e){var t=this;e.preventDefault(),this.relationship.getValue("isContact")&&(this.relationship.registry.toggleFollowing(this.nsid),this.relationship.registry.remoteUpdate(this.nsid).then((function(){t.disableRefreshOnRelationshipChange||i.config.win.location.reload()}),(function(i){t.relationship.setValue("isContact",!0),t.buildContainer(),n.error({err:i})})),i.rapidTracker.beacon(this.name,"unfollowButtonClick"),this.fire("onUnfollow"))},handleFriendChange:function(e){var t=this;this.relationship.registry.toggleFriend(this.nsid),this.relationship.registry.remoteUpdate(this.nsid).then((function(){t.disableRefreshOnRelationshipChange||i.config.win.location.reload()}),(function(i){t.relationship.registry.toggleFriend(t.nsid),t.buildContainer(),t.onError(t.intlMessage({intlName:"person.RELATIONSHIP_FRIEND_ERROR"})),n.error({err:i})}))},handleFamilyChange:function(e){var t=this;this.relationship.registry.toggleFamily(this.nsid),this.relationship.registry.remoteUpdate(this.nsid).then((function(){t.disableRefreshOnRelationshipChange||i.config.win.location.reload()}),(function(i){t.relationship.registry.toggleFamily(t.nsid),t.buildContainer(),t.onError(t.intlMessage({intlName:"person.RELATIONSHIP_FAMILY_ERROR"})),n.error({err:i})}))}})}),"@VERSION@",{requires:["promise","hermes-template-following-dropdown"],optionalRequires:["hermes-core"],langBundles:["common","person"]});YUI.add("hermes-lang-person",(function(e,o){e.Intl.add("hermes/person","en-US",{MESSAGE:[{type:0,value:"Message"}],ALBUMS:[{type:0,value:"Albums"}],FAVES:[{type:0,value:"Faves"}],PROFILE:[{type:0,value:"Profile"}],NO_PHOTOS:[{type:0,value:"This user has no photos visible to you."}],NO_LONGER_ON_FLICKR:[{type:0,value:"This user is not found, or no longer on Flickr."}],ERROR_LOADING:[{type:0,value:"Error loading user card. Please try again."}],RELATIONSHIP_FRIEND_ERROR:[{type:0,value:"There was a problem setting your friend relationship."}],RELATIONSHIP_FAMILY_ERROR:[{type:0,value:"There was a problem setting your family relationship."}],SIGN_IN_BEFORE_FOLLOW_TITLE:[{type:0,value:"You found someone to follow!"}],SIGN_IN_BEFORE_FOLLOW_MESSAGE:[{type:0,value:"That’s awesome. Just sign in to follow them."}],JOIN_FLICKR_AND_FOLLOW:[{type:0,value:"Join Flickr to never miss a post from "},{type:1,value:"person"},{type:0,value:"."}],SIGN_IN_AND_FOLLOW:[{type:0,value:"Sign in and follow"}],CURATOR_PASS_OVER:[{type:0,value:"Pass over"}],CURATOR_PASS_OVER_UNDO:[{type:0,value:"Undo pass over"}]})}),"@VERSION@",{requires:["intl"]});